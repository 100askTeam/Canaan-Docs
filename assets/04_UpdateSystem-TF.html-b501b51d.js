import{_ as o,r as i,o as r,c as d,a as e,b as a,d as t,e as s}from"./app-e64799d6.js";const c={},l=e("h1",{id:"使用tf卡更新emmc系统",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#使用tf卡更新emmc系统","aria-hidden":"true"},"#"),a(" 使用TF卡更新EMMC系统")],-1),p=e("p",null,"硬件要求：",-1),m=e("ul",null,[e("li",null,"DongshanPI-Vision开发板"),e("li",null,"microSD卡（建议最小8G）"),e("li",null,"Type-c数据线 x2")],-1),h=e("p",null,"软件要求：",-1),u={href:"https://dongshanpi.cowtransfer.com/s/bac8fbdce7c046",target:"_blank",rel:"noopener noreferrer"},g={href:"https://www.sdcard.org/downloads/formatter_4/eula_windows/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://www.balena.io/etcher",target:"_blank",rel:"noopener noreferrer"},b={href:"https://mobaxterm.mobatek.net/",target:"_blank",rel:"noopener noreferrer"},_={href:"https://dongshanpi.cowtransfer.com/s/bac8fbdce7c046",target:"_blank",rel:"noopener noreferrer"},f={href:"https://dongshanpi.cowtransfer.com/s/5482c150ff6147",target:"_blank",rel:"noopener noreferrer"},x=e("blockquote",null,[e("p",null,"由于我们需要使用SD卡烧录EMMC镜像，在开始前，我们需要先制作SD卡镜像！！！！")],-1),k=e("h2",{id:"_1-制作sd卡镜像",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_1-制作sd卡镜像","aria-hidden":"true"},"#"),a(" 1.制作SD卡镜像")],-1),S=e("h3",{id:"_1-1-格式化microsd卡",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_1-1-格式化microsd卡","aria-hidden":"true"},"#"),a(" 1.1 格式化microSD卡")],-1),D={href:"https://www.sdcard.org/downloads/formatter_4/eula_windows/",target:"_blank",rel:"noopener noreferrer"},w=s('<p><img src="http://photos.100ask.net/canaan-docs/image-20230721165711205.png" alt="image-20230721165711205"></p><p>点击完成后会弹出下图所示的提示框，该提示警告我们格式化将清空卡中的所有数据，询问我们是否继续，这里点击<code>是</code></p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721165954580.png" alt="image-20230721165954580"></p><p>等待格式化完成后，会弹出以下对话框，提示我们格式化后的文件系统为<code>FAT32</code>以及内存大小可用空间，点击确定即可完成SD卡的格式化。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721170207480.png" alt="image-20230721170207480"></p><h3 id="_1-2-使用etcher烧录镜像" tabindex="-1"><a class="header-anchor" href="#_1-2-使用etcher烧录镜像" aria-hidden="true">#</a> 1.2 使用Etcher烧录镜像</h3><p>​ 使用Etcher将DongshanPI-Vision开发板SD卡镜像写入您的microSD卡。</p>',7),M={href:"https://www.balena.io/etcher",target:"_blank",rel:"noopener noreferrer"},E=s(`<p><img src="http://photos.100ask.net/canaan-docs/image-20230721170709568.png" alt="image-20230721170709568"></p><p>点击<code>Flash from file</code>，如下图所示，点击下图红框处。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721170746679.png" alt="image-20230721170746679"></p><p>此时会弹出文件资源管理器，选择您刚刚下载的DongshanPI-Vision开发板SD卡镜像。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721171028315.png" alt="image-20230721171028315"></p><p>选择完成后会，显示下面的界面，点击下图中红框处<code>Select target</code>，选择要写入的目标microSD卡。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721172244447.png" alt="image-20230721172244447"></p><p>点击完成后会弹出选择目标，此时选择您通过读卡器插入电脑中的microSD卡。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721172220680.png" alt="image-20230721172220680"></p><p>选择完成后，会显示以下界面，点击<code>Flash</code>后即可开始烧写。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721172614694.png" alt="image-20230721172614694"></p><p>如下图所示等待烧写完成即可。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721172653819.png" alt="image-20230721172653819"></p><p>使用Etcher烧写完成后，Windows可能会不知道如何读取您的microSD卡，会弹出如下图所示警告，点击<code>取消</code>后拔出microSD卡即可。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721172939202.png" alt="image-20230721172939202"></p><h3 id="_1-3-启动sd卡系统" tabindex="-1"><a class="header-anchor" href="#_1-3-启动sd卡系统" aria-hidden="true">#</a> 1.3 启动SD卡系统</h3><p>​ 将下图中的拨码开关的boot0向下拨和boot1向上拨，使开发板进入SD卡启动模式。将SD卡插入开发板的卡槽中，步骤如下图所示：</p><p><img src="http://photos.100ask.net/canaan-docs/k510-board-Install-sd-card.png" alt="k510-board-Install-sd-card"></p><p>使用两条Type-C线连接开发板端和电脑端，用于给开发板进行供电和使用串口登录开发板控制台。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721184330238.png" alt="image-20230721184330238"></p><p>使用串口软件查看串口控制台，成功启动后会进入开发板控制台。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721184905618.png" alt="image-20230721184905618"></p><h2 id="_2-拷贝镜像到sd卡的用户分区" tabindex="-1"><a class="header-anchor" href="#_2-拷贝镜像到sd卡的用户分区" aria-hidden="true">#</a> 2.拷贝镜像到SD卡的用户分区</h2><p>在拷贝镜像前，我们需要在开发板端的SD卡的用户分区中新建任意文件，这样可以使得我们在Windows电脑端可以识别到SD卡的用户分区。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[root@canaan ~ ]$ ls
data  emmc  sd
[root@canaan ~ ]$ cd sd/p3/
[root@canaan ~/sd/p3 ]$ ls
System Volume Information  coredump
[root@canaan ~/sd/p3 ]$ touch 1.txt
[root@canaan ~/sd/p3 ]$ echo 100ask &gt; 1.txt
[root@canaan ~/sd/p3 ]$ cat 1.txt
100ask
[root@canaan ~/sd/p3 ]$ sync
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来断开 开发板的电源，取下SD卡，并使用读卡器通过USB口插入您的PC电脑，此时电脑可以读取到U盘的两个分区，如下图所示：</p><p><img src="http://photos.100ask.net/canaan-docs/image-20240522161005145.png" alt="image-20240522161005145"></p>`,27),C={href:"https://zhuanlan.zhihu.com/p/616381018",target:"_blank",rel:"noopener noreferrer"},y=s(`<p>将EMMC镜像拷贝到SD卡的用户空间分区中，如下所示：</p><p><img src="http://photos.100ask.net/canaan-docs/image-20240522161516402.png" alt="image-20240522161516402"></p><blockquote><p>注意：我们在用户空间中创建1.txt，您可以查看分区是否有1.txt来确定操作的分区是否为用户空间分区。</p></blockquote><p>拷贝完成后，将SD卡插回开发板上，并使用SD卡插入开发板并上电启动系统。</p><h2 id="_3-烧录emmc镜像" tabindex="-1"><a class="header-anchor" href="#_3-烧录emmc镜像" aria-hidden="true">#</a> 3.烧录emmc镜像</h2><p>使用串口软件查看串口控制台，等待系统成功启动。系统启动后进入sd卡中的用户空间，查看EMMC镜像文件</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[root@canaan ~ ]$ cd sd/p
p1/  p2/  p3/
[root@canaan ~ ]$ cd sd/p3/
[root@canaan ~/sd/p3 ]$ ls
1.txt                      coredump
System Volume Information  sysimage-emmc.img
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>烧录emmc镜像前，需要卸载掉emmc相关文件系统，在开始前，我们先查看一下EMMC相关的系统挂载信息。输入：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mount | grep emmc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输入结果如下所示：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[root@canaan ~/sd/p3 ]$ mount | grep emmc
/dev/mmcblk0p3 on /root/emmc/p3 type ext2 (rw,relatime,errors=continue)
/dev/mmcblk0p4 on /root/emmc/p4 type vfat (rw,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro)
/dev/mmcblk0p2 on /root/emmc/p2 type vfat (rw,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到系统挂载到了<code>mmcblk0p2</code>、<code>mmcblk0p3</code>、<code>mmcblk0p4</code>这三个分区中，接下来我们手动卸载这三个分区，输入：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>umount /root/emmc/p2
umount /root/emmc/p3
umount /root/emmc/p4
mount | grep emmc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行结果如下所示：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[root@canaan ~/sd/p3 ]$ umount /root/emmc/p2
[root@canaan ~/sd/p3 ]$ umount /root/emmc/p3
[root@canaan ~/sd/p3 ]$ umount /root/emmc/p4
[root@canaan ~/sd/p3 ]$ mount | grep emmc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>卸载完成后，可以发现已经找不到EMMC系统的挂载信息了，输入如下命令烧录EMMC:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dd if=sysimage-emmc.img of=/dev/mmcblk0 bs=1M
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>执行结果如下图：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>root@canaan ~/sd/p3 ]$ dd if=sysimage-emmc.img of=/dev/mmcblk0 bs=1M
544+0 records in
544+0 records out
570425344 bytes (544.0MB) copied, 27.453821 seconds, 19.8MB/s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>注：烧录过程较慢，大约需要30秒，请耐心等待。</strong></p><p>当烧录完成后，选择 BOOT为从EMMC启动，最后开发板上电即可从EMMC启动。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721174905407.png" alt="image-20230721174905407"></p><p>使用串口软件查看串口控制台，成功启动后会进入开发板控制台。</p><p><img src="http://photos.100ask.net/canaan-docs/image-20230721175557977.png" alt="image-20230721175557977"></p>`,24);function $(I,V){const n=i("ExternalLinkIcon");return r(),d("div",null,[l,p,m,h,e("ul",null,[e("li",null,[e("p",null,[a("DongshanPI-Vision开发板SD卡镜像："),e("a",u,[a("https://dongshanpi.cowtransfer.com/s/bac8fbdce7c046"),t(n)])])]),e("li",null,[e("p",null,[a("SD卡格式化工具:"),e("a",g,[a("SD Memory Card Formatter"),t(n)])])]),e("li",null,[e("p",null,[a("SD卡刷机工具："),e("a",v,[a("ETCHER"),t(n)])])]),e("li",null,[e("p",null,[a("串口工具："),e("a",b,[a("MobaXterm"),t(n)])])])]),e("p",null,[a("开始前请下载DongshanPI-Vision开发板"),e("a",_,[a("SD卡镜像"),t(n)]),a("和"),e("a",f,[a("EMMC镜像"),t(n)]),a(" ，并记住它在计算机中保存的位置。")]),x,k,S,e("p",null,[a("将您的SD卡使用读卡器通过USB口插入您的PC电脑，使用SD卡格式化工具"),e("a",D,[a("SD Memory Card Formatter"),t(n)]),a("格式化您的SD卡。点击下图中红框位置，开始格式化内存卡。")]),w,e("p",null,[a("​ 下载"),e("a",M,[a("Etcher"),t(n)]),a("烧写工具并安装它。启动Etcher应用程序，启动后界面如下图所示：")]),E,e("blockquote",null,[e("p",null,[a("如果读取不到用户空间分区可使用DiskGenius软件读取分区，参考链接："),e("a",C,[a("如何在Windows下读写Ext4/3/2分区？（DiskGenius教程）"),t(n)])])]),y])}const B=o(c,[["render",$],["__file","04_UpdateSystem-TF.html.vue"]]);export{B as default};
